# parameters:
  ENABLE_WHITEBOX_SDK:
    desc: "Add Whitebox-sdk features"
    "no":
      desc: "Nothing to do"
    "yes":
      default: true
      overrides:
        components:
          dom0:
            builder:
              layers:
                - "../../../meta-rcar-whitebox/meta-dom0"
          domd:
            builder:
              conf:
                - [IMAGE_INSTALL_append, " iproute2-tc snort"]
                - [IMAGE_INSTALL_append, " iccom-lib iccom-test"]
                - [IMAGE_INSTALL_append, " docker python3-docker-compose"]
                - [IMAGE_INSTALL_append, " dhrystone whetstone sysbench"]
                - [IMAGE_INSTALL_append, " waii packagegroup-system-monitor"]
                - [EXTRA_IMAGEDEPENDS_append, " s4-boot-script"]
              layers:
                - "../../../meta-rcar-whitebox/meta-rcar-common"
                - "../../../meta-rcar-whitebox/meta-domd"
              target_images:
                - "tmp/work/spider-poky-linux/rcar-image-minimal/1.0-r0/rootfs/var/statestorage.db"
                - "tmp/deploy/images/%{MACHINE}/boot-emmc.uImage"
          domu:
            builder:
              conf:
                - [IMAGE_INSTALL_append, " iproute2 iproute2-tc"]
        images:
          full:
            partitions:
              domd_rootfs:
                size: 2048 MiB
              domd_var:
                size: 1024 MiB
                files:
                  "statestorage.db": "%{YOCTOS_WORK_DIR}/build-domd/tmp/work/%{MACHINE}-poky-linux/rcar-image-minimal/1.0-r0/rootfs/var/statestorage.db"
                  "boot-emmc.uImage": "%{YOCTOS_WORK_DIR}/build-domd/tmp/deploy/images/%{MACHINE}/boot-emmc.uImage"
              domd_aos:
                size: 2048 MiB
