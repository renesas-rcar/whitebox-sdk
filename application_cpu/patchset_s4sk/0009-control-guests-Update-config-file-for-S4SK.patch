From f6721a33df5d2518057fee21484ead54c30cc196 Mon Sep 17 00:00:00 2001
From: Duy Dang <duy.dang.yw@renesas.com>
Date: Fri, 16 Jun 2023 19:31:04 +0900
Subject: [PATCH 09/14] control: guests: Update config file for S4SK

Signed-off-by: Duy Dang <duy.dang.yw@renesas.com>
---
 .../files/{domd-spider.cfg => domd-s4sk.cfg}  | 30 ++++++++++++-------
 .../files/{domu-spider.cfg => domu-s4sk.cfg}  |  1 +
 2 files changed, 21 insertions(+), 10 deletions(-)
 rename meta-aos-rcar-gen4-control-domain/recipes-guests/domd/files/{domd-spider.cfg => domd-s4sk.cfg} (90%)
 rename meta-aos-rcar-gen4-control-domain/recipes-guests/domu/files/{domu-spider.cfg => domu-s4sk.cfg} (97%)

diff --git a/meta-aos-rcar-gen4-control-domain/recipes-guests/domd/files/domd-spider.cfg b/meta-aos-rcar-gen4-control-domain/recipes-guests/domd/files/domd-s4sk.cfg
similarity index 90%
rename from meta-aos-rcar-gen4-control-domain/recipes-guests/domd/files/domd-spider.cfg
rename to meta-aos-rcar-gen4-control-domain/recipes-guests/domd/files/domd-s4sk.cfg
index a59da1c..538cba4 100644
--- a/meta-aos-rcar-gen4-control-domain/recipes-guests/domd/files/domd-spider.cfg
+++ b/meta-aos-rcar-gen4-control-domain/recipes-guests/domd/files/domd-s4sk.cfg
@@ -10,11 +10,9 @@ name = "DomD"
 # Kernel image to boot
 kernel = "/usr/lib/xen/boot/linux-domd"
 
-ramdisk = "/usr/lib/xen/boot/initramfs-domd"
-
 device_tree = "/usr/lib/xen/boot/domd.dtb"
 
-extra = "root=/dev/STORAGE_PART4 ro rootwait console=hvc0 clk_ignore_unused pci=pcie_bus_perf vardir.disk=/dev/STORAGE_PART5 opendisk.target=/dev/STORAGE_PART6 opendisk.pkcs11=optee aosupdate.disk=/dev/aosvg/downloads aosupdate.path=update_rootfs"
+extra = "root=/dev/STORAGE_PART2 rw rootwait console=hvc0 clk_ignore_unused pci=pcie_bus_perf"
 
 # Initial memory allocation (MB)
 memory = 1024
@@ -28,7 +26,7 @@ tee = "optee"
 
 # This is autogenerated config part
 
-dt_compatible = [ "renesas,spider-breakout", "renesas,spider-cpu", "renesas,r8a779f0" ]
+dt_compatible = [ "renesas,s4sk", "renesas,r8a779f0" ]
 
 # Clocks and regulators are needed and are in the device tree root,
 # but we do not want to copy all root nodes: handle these one by one
@@ -36,11 +34,13 @@ dt_passthrough_nodes = [
     "/extal",
     "/extalr",
     "/msiof-ref-clock",
+    "/ufs30_refclk_v",
     "/pcie_bus",
     "/scif",
     "/soc",
     "/regulator-1p8v",
     "/regulator-3p3v",
+    "/regulator-vcc-sdhi",
     "/reserved-memory",
 ]
 
@@ -50,6 +50,7 @@ dtdev = [
     "/soc/mmc@ee140000",
     "/soc/ethernet@e68c0000",
     "/soc/pcie@e65d0000",
+    "/soc/scsi@e6860000",
 ]
 
 irqs = [
@@ -61,10 +62,12 @@ irqs = [
     856,
 # gpio@e6051980
     857,
-# i2c@e6500000
-    270,
+# i2c@e6510000
+    272,
 # i2c@e66d8000
     274,
+# i2c@e66e0000
+    275,
 # serial@e6550000
     278,
 # serial@e6e60000
@@ -87,7 +90,7 @@ irqs = [
     128, 129, 130, 131, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127,
 # pcie@e65d0000
     448, 449, 450, 451, 452, 453, 454,
-# mfis@e6260000
+# iccom00
     352,
 # iccom01
     354,
@@ -122,6 +125,8 @@ irqs = [
 # ethernet@e68c0000
     312, 313, 314, 315, 316, 317, 318, 319, 320, 321,
     322, 323, 324, 325, 326, 327, 328, 329, 330, 331,
+# scsi@e6860000 (UFS)
+    267,
 ]
 
 iomem = [
@@ -149,10 +154,12 @@ iomem = [
     "e6160,4",
 #system-controller@e6180000
     "e6180,4",
-#i2c@e6500000
-    "e6500,1",
+#i2c@e6510000
+    "e6510,1",
 #i2c@e66d8000
     "e66d8,1",
+#i2c@e66e0000
+    "e66e0,1",
 #ethernet@e68c0000
     "e68c0,20",
 #ethernet@e68c0000
@@ -212,7 +219,8 @@ iomem = [
     "e61a0,1",
     "e61a8,1",
     "e61b0,1",
-#mfis@e6260000
+#iccom_reg_00 - mfis@e6260000
+#iccom00
 #iccom01
 #iccom02
 #iccom03
@@ -247,6 +255,8 @@ iomem = [
     "e6260,10",
 #iccom shared memory (CTA) - CR52
     "47fc7,2@37fc7",
+#scsi@e6860000 (UFS)
+    "e6860,1",
 ]
 
 # End of autogenerated config part
diff --git a/meta-aos-rcar-gen4-control-domain/recipes-guests/domu/files/domu-spider.cfg b/meta-aos-rcar-gen4-control-domain/recipes-guests/domu/files/domu-s4sk.cfg
similarity index 97%
rename from meta-aos-rcar-gen4-control-domain/recipes-guests/domu/files/domu-spider.cfg
rename to meta-aos-rcar-gen4-control-domain/recipes-guests/domu/files/domu-s4sk.cfg
index 58b6f19..892ada5 100644
--- a/meta-aos-rcar-gen4-control-domain/recipes-guests/domu/files/domu-spider.cfg
+++ b/meta-aos-rcar-gen4-control-domain/recipes-guests/domu/files/domu-s4sk.cfg
@@ -30,6 +30,7 @@ tee = "optee"
 on_crash = 'preserve'
 
 dt_passthrough_nodes = [
+    "/regulator-vcc-sdhi",
     "/reserved-memory",
 ]
 
-- 
2.25.1

